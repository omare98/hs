## USTRA HR 공통 함수 및 컴포넌트

### Java

1. CommonUtils.java
    * 공통 유틸클래스 CommonUtils 추가
        * resNoMasking() : 주민번호 마스킹
        * emailMasking() : 이메일 마스킹
        * phoneNumberMasking() : 휴대전화번호 마스킹
        * nameMasking() : 이름 마스킹
        * acctNoMasking() : 계좌번호 마스킹
        * creditCardNoMasking() : 신용카드번호 마스킹
        * escapeHtml() : html escape 처리
        * unescapeHtml() : html unescape 처리
2. SecurityUtils.java
    * 보안 유틸클래스 SecurityUtils 추가
        * getAuthenticationUserDto() : 인증체크 후 사용자 정보(AuthenticationUserDto) get

### Javascript

1. common-utils.js
    * 공통 유틸함수 CommonUtils 추가
        * getConfigValue() : 설정값 조회
        * getConfigValueList() : 설정값 목록 조회
        * getConfigValueSY001() : 전자결재(SY001) 설정값 조회
        * getConfigValueAS001List() : 발령요소 설정값 목록 조회
        * getCommonCodeList() : 공통코드 목록 조회

        ```js
        CommonUtils.getCommonCodeList([
            { 
                patternCode: 'AP02', 
                returnKey: 'ap02List', 
                bindList: [
                    {
                        bindId: 'select-commonCode', 
                        bindType: CommonUtils.BIND_TYPE.SELECT, 
                        selectedVal: 'CE',
                        placeholder: '전체'
                    },
                    {
                        bindId: 'radio-commonCode', 
                        bindType: CommonUtils.BIND_TYPE.RADIO, 
                        selectedVal: 'CE'
                    }
                ]
            }, 
            {
                patternCode: 'AIRF', 
                returnKey: 'airfList', 
                bindList: [
                    {
                        bindId: 'select-multi',
                        bindType: CommonUtils.BIND_TYPE.MULTI, 
                        selectedVals: ['A', 'B', 'C'],
                        placeholder: '전체'
                    }
                ]
            },
            {
                patternCode: 'AP03', 
                returnKey: 'ap03List', 
                bindList: [
                    {
                        bindId: 'checkbox-commonCode', 
                        bindType: CommonUtils.BIND_TYPE.CHECKBOX, 
                        isCheckAll: false
                    }
                ]
            }
        ]).then(result => {
            // result array 내용
            [
                {ap02List : [{code: '', codeName: ''}, {...}]},    // AP02 의 코드 정보 
                {airfList : [...]},    // AIRF 의 코드 정보
                {ap03List : [...]}     // AP03 의 코드 정보
            ]
        });
        ```

        * requestJsonGet : json 형식의 데이터 GET 방식 서버요청
        * requestJsonPost : json 형식의 데이터 POST 방식 서버요청
        * requestJsonPut : json 형식의 데이터 PUT 방식 서버요청
        * requestJsonDelete : json 형식의 데이터 DELETE 방식 서버요청

        ```js
        /**
         * @param {string} url                      URL
         * @param {object} paramObj                 파라미터 Object
         * @param {Function||string} callback       callback 함수
         * @param {boolean} async                   비동기 여부
         */
        CommonUtils.requestJsonPost('url', {paramObject}, (result) => {
            alert(result.notifResult);
        }, true);
        ```

        * toCamelCase() : 카멜 케이스로 변환
        * toPascalCase() : 파스칼 케이스로 변환
        * toSnakeCase() : 스네이크 케이스로 변환
        * toKebabCase() : 케밥케이스로 변환
        * getMngOfficeCodeList() : 관리사업장코드 목록 조회
        * getMngOfficeRelCodeList() : 관리사업장-사업장관계코드 목록 조회
        * getOfficeCodeList() : 사업장코드 목록 조회
        * getCodeListFromSelect() : select 태그의 option 정보에서 코드목록 생성
        * getCodeListFromMulti() : select 태그의 multiple option 정보에서 코드목록 생성
        * getCodeListFromCheckbox() : checkbox 태그의 정보에서 코드목록 생성
        * getCodeListFromRadio() : radio 태그의 정보에서 코드목록 생성

2. common.js
* 파일관련 기능함수 추가
    * setFileList() : 파일목록정보 생성
    * getAtchFileId() : 파일 업로드 후 첨부파일ID 가져오기
    * common-utils.html 파일 참조
    ```html
    <div class="file-upload">
        <div class="field is-grouped">
            <div class="file">
                <label class="file-label">
                    <span class="button is-filled is-primary is-medium">파일찾기</span>
                    <input type="file" name="files" class="file-input" multiple="multiple"/>
                </label>
            </div>

            <span>최대 20MB까지 첨부하실 수 있습니다.</span>
        </div>
        <div class="file-table">
            <table id="fileDrop" class="table-file is-fullwidth">
                <tr><td></td></tr>
            </table>
        </div>
        <div id="file-fileInfo"></div>
    </div>
  
    <script type="application/javascript">
    // 파일드롭 zone
    const $fileDrop = $('#fileDrop').fileDrop ({
        fileEl: 'files' // 파일 element id
        // 파일크기제한, 기본 20M
        // uploadLimit: 1024 * 1024 * 20,
        // 업로드 가능한 파일 포맷
        // extentions: [ 'hwp', 'doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx', 'txt' ]
    });
    
    // 업로드한 첨부파일ID 의 첨부파일 목록을 'fileList' div에 추가  
    $fileDrop.setFileList('첨부파일ID', 'fileList');
    
    // getAtchFileId 은 첨부파일 업로드 후 첨부파일ID 를 Promise로 리턴
    $fileDrop.getAtchFileId('첨부파일ID').then(atchFileId => {
        console.log('atchFileId : ', atchFileId);
        if (!_.isEmpty(atchFileId)) {
            $.alert('저장 되었습니다.', () => {
                $fileDrop.setFileList(atchFileId, 'fileList');
            });
        }
    });
    </script>
    ```

### Components

1. /templates/components/input.html
    * class 명에 따른 입력제어 추가 (addClass 에 입력)
        * num-only : 숫자만 입력받음
        * num-comma : 숫자 + 3자리 콤마
        * alpha-only : 영문만
        * han-only : 한글만
        * alpha-han-only : 영문, 한글만

        ```html
        <th:block th:replace="components/input :: input(
            id='numOnly',
            name='numOnly',
            required=true,
            textAlign='left',
            addClass='input num-only',
            maxLength='3',
            title='숫자만 입력'
            )">
        </th:block>
        ```